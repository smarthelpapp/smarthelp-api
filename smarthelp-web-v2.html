<!doctype html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>SmartHelp ‚Äì Web v2</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --purple:#6C63FF; --blue:#3DA9FC; --bg:#F7F8FC; --surface:#FFFFFF; --text:#0F172A; --muted:#64748B;
    --ring: rgba(108,99,255,.35);
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; font-family:Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
    color:var(--text); background:linear-gradient(180deg,#F0F3FF 0%, #F7F8FC 100%);
  }
  .container{max-width:1100px;margin:0 auto;padding:24px 16px}

  /* Header */
  .hero{position:sticky;top:0;z-index:10;background:linear-gradient(90deg,var(--purple),var(--blue));
    color:#fff;box-shadow:0 4px 16px rgba(0,0,0,.08)}
  .hero-inner{display:flex;gap:12px;align-items:center;justify-content:space-between; padding:14px 16px;max-width:1100px;margin:0 auto}
  .brand{display:flex;gap:10px;align-items:center}
  .logo{width:34px;height:34px;border-radius:10px;background:#fff;display:grid;place-items:center;color:var(--purple);font-weight:800}
  .title{margin:0;font-size:18px;font-weight:800;letter-spacing:.2px}
  .api-chip{opacity:.9;font-size:12px;background:rgba(255,255,255,.15);padding:6px 10px;border-radius:999px}
  .cta{background:#fff;color:#1f2a44;border:0;padding:10px 14px;border-radius:10px;font-weight:700;cursor:pointer}
  .cta:hover{filter:brightness(0.95)}

  /* Tabs */
  .tabs{position:sticky;top:62px;background:rgba(255,255,255,.6);backdrop-filter:blur(8px);
    border-bottom:1px solid #e5e7eb}
  .tabs-inner{max-width:1100px;margin:0 auto;display:flex;gap:8px;flex-wrap:wrap;padding:10px 16px}
  .tab{
    padding:10px 12px;border:1px solid #e5e7eb;background:#fff;border-radius:12px;cursor:pointer;
    transition:.15s transform, .15s box-shadow; display:flex; gap:8px; align-items:center;
  }
  .tab:hover{transform:translateY(-1px);box-shadow:0 6px 16px rgba(0,0,0,.06)}
  .tab.active{background:linear-gradient(180deg,#EEF1FF,#FFFFFF);border-color:#dfe2ff;
    box-shadow:0 6px 18px var(--ring)}
  .tab .ico{font-size:16px}

  main{padding:18px 16px}
  section{display:none; animation:fade .2s ease}
  @keyframes fade{from{opacity:0;transform:translateY(4px)} to{opacity:1;transform:none}}

  /* Cards / inputs */
  .grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:14px}
  .card{background:var(--surface);border:1px solid #E5E7EB;border-radius:16px;padding:16px;
         box-shadow:0 6px 20px rgba(17,24,39,0.06)}
  h3{margin:0 0 10px 0;font-size:16px}
  .row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
  input,select,button{padding:11px 12px;border:1px solid #e5e7eb;border-radius:12px;outline:none;
    font:inherit;background:#fff}
  input:focus,select:focus{box-shadow:0 0 0 4px var(--ring);border-color:#c7ccff}
  button{background:var(--purple);color:#fff;border:0;font-weight:700;cursor:pointer}
  button.secondary{background:var(--blue)}
  .muted{color:var(--muted)}
  .pill{display:inline-block;padding:2px 8px;border-radius:999px;background:#EEF2FF;border:1px solid #dbeafe;margin-right:6px;font-size:12px}
  .list li{margin:6px 0}
  .skeleton{height:12px;background:#eceff7;border-radius:6px;animation:pulse 1.1s infinite ease-in-out}
  @keyframes pulse{0%{opacity:.8}50%{opacity:.5}100%{opacity:.8}}

  /* Footer */
  footer{padding:24px 16px;text-align:center;color:#94a3b8;font-size:13px}
</style>
<script>
  const API_URL = "https://smarthelp-api.onrender.com";

  async function get(p){ const r=await fetch(API_URL+p); if(!r.ok) throw new Error('API'); return r.json(); }
  async function post(p,b){ const r=await fetch(API_URL+p,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(b||{})}); if(!r.ok) throw new Error('API'); return r.json(); }

  function showTab(id){
    document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
    document.querySelectorAll('section').forEach(s=>s.style.display='none');
    document.getElementById('tab-'+id).classList.add('active');
    document.getElementById('sec-'+id).style.display='block';
  }

  // -------- RUTƒ∞N --------
  async function loadRoutine(){
    const out=document.getElementById('routine-out');
    out.innerHTML='<div class="skeleton" style="width:70%"></div><div class="skeleton" style="width:40%;margin-top:8px"></div>';
    try{ const d=await get('/daily/routine');
      out.innerHTML=`
      <div class="grid">
        <div class="card"><h3>‚úÖ G√∂revler</h3>
          <ul class="list">${(d.tasks||[]).map(t=>`<li>‚Ä¢ ${t.title}</li>`).join('')||'<span class="muted">G√∂rev yok</span>'}</ul>
        </div>
        <div class="card"><h3>üçΩÔ∏è Yemek</h3>
          <div><b>${d.meal?.title||'-'}</b> <span class="muted">(${d.meal?.kcal||'?'} kcal)</span></div>
          ${(d.meal?.missing||[]).length?`<div class="muted">Eksik: ${d.meal.missing.join(', ')}</div>`:''}
        </div>
        <div class="card"><h3>üëî Stil</h3>
          <div>${(d.style?.tops||[]).join(', ')}<br>${(d.style?.bottoms||[]).join(', ')}<br>${(d.style?.shoes||[]).join(', ')}</div>
          <div class="muted">${(d.style?.extras||[]).join(', ')}</div>
        </div>
        <div class="card"><h3>üé¨ ƒ∞zle</h3>
          <div><b>${d.watch?.title||'-'}</b> <span class="muted">(${d.watch?.year||''})</span></div>
        </div>
        <div class="card"><h3>üå§ Hava</h3><div>${d.weather?.summary||'-'}</div></div>
      </div>`;
    }catch(e){ out.innerHTML='<span class="muted">Baƒülantƒ± hatasƒ±</span>'; }
  }

  // -------- YEMEK --------
  async function searchRecipes(){
    const q=document.getElementById('food-q').value.trim();
    const diet=document.getElementById('food-diet').value;
    const out=document.getElementById('food-out'); out.innerHTML='<div class="skeleton" style="width:60%"></div>';
    try{ const d=await get(`/recipes/search?q=${encodeURIComponent(q)}${diet?`&diet=${diet}`:''}`);
      out.innerHTML=d.map(r=>`
        <div class="card">
          <b>${r.title}</b> <span class="muted">(${r.kcal} kcal)</span><br>
          <div class="muted">${r.ingredients.join(', ')}</div>
          <div style="margin-top:6px">${(r.tags||[]).map(t=>`<span class="pill">${t}</span>`).join('')}</div>
        </div>`).join('')||'<div class="muted">Sonu√ß yok</div>';
    }catch(e){ out.innerHTML='<span class="muted">Baƒülantƒ± hatasƒ±</span>'; }
  }
  async function byIngredients(){
    const ing=document.getElementById('food-ings').value.trim();
    const diet=document.getElementById('food-diet').value;
    const out=document.getElementById('food-out'); out.innerHTML='<div class="skeleton" style="width:60%"></div>';
    try{ const d=await get(`/recipes/by-ingredients?ingredients=${encodeURIComponent(ing)}${diet?`&diet=${diet}`:''}`);
      out.innerHTML=d.map(r=>`
        <div class="card">
          <b>${r.title}</b> <span class="muted">(${r.kcal} kcal)</span><br>
          <div class="muted">Eksik: ${(r.missing||[]).join(', ')||'-'}</div>
        </div>`).join('')||'<div class="muted">Sonu√ß yok</div>';
    }catch(e){ out.innerHTML='<span class="muted">Baƒülantƒ± hatasƒ±</span>'; }
  }

  // -------- Fƒ∞LM --------
  async function searchMovies(){
    const q=document.getElementById('movie-q').value.trim();
    const out=document.getElementById('movie-out'); out.innerHTML='<div class="skeleton" style="width:50%"></div>';
    try{ const d=await get(`/watch/recommend?q=${encodeURIComponent(q)}`);
      out.innerHTML=d.map(m=>`
        <div class="card"><b>${m.title}</b> <span class="muted">(${m.year})</span>
        <div class="muted">${(m.genres||[]).join(', ')}</div></div>`).join('')||'<div class="muted">Sonu√ß yok</div>';
    }catch(e){ out.innerHTML='<span class="muted">Baƒülantƒ± hatasƒ±</span>'; }
  }

  // -------- G√ñREVLER --------
  async function loadTasks(){
    const out=document.getElementById('tasks-out'); out.innerHTML='<div class="skeleton" style="width:40%"></div>';
    try{ const d=await get('/tasks');
      out.innerHTML=d.map(t=>`
        <div class="card">
          <div class="row" style="justify-content:space-between;align-items:center">
            <div>${t.isDone?'‚úÖ':'üü£'} ${t.title}</div>
            ${t.isDone?'':`<button onclick="doneTask(${t.id})">Tamamla</button>`}
          </div>
        </div>`).join('')||'<div class="muted">G√∂rev yok</div>';
    }catch(e){ out.innerHTML='<span class="muted">Baƒülantƒ± hatasƒ±</span>'; }
  }
  async function addTask(){
    const title=document.getElementById('task-title').value.trim();
    if(!title) return alert('Ba≈ülƒ±k yaz');
    await post('/tasks',{title}); document.getElementById('task-title').value=''; loadTasks();
  }
  async function doneTask(id){ await post(`/tasks/${id}/done`); loadTasks(); }

  // -------- STƒ∞L --------
  async function styleSuggest(){
    const oc=document.getElementById('st-oc').value;
    const we=document.getElementById('st-we').value;
    const ge=document.getElementById('st-ge').value;
    const out=document.getElementById('style-out'); out.innerHTML='<div class="skeleton" style="width:55%"></div>';
    try{ const d=await get(`/style/suggest?occasion=${encodeURIComponent(oc)}&weather=${encodeURIComponent(we)}&gender=${encodeURIComponent(ge)}`);
      out.innerHTML=`
        <div class="card">
          <div><b>√úst:</b> ${(d.tops||[]).join(', ')||'-'}</div>
          <div><b>Alt:</b> ${(d.bottoms||[]).join(', ')||'-'}</div>
          <div><b>Ayakkabƒ±:</b> ${(d.shoes||[]).join(', ')||'-'}</div>
          <div class="muted">${(d.extras||[]).join(', ')||''}</div>
        </div>`;
    }catch(e){ out.innerHTML='<span class="muted">Baƒülantƒ± hatasƒ±</span>'; }
  }

  window.addEventListener('DOMContentLoaded',()=>{
    document.getElementById('apiurl').textContent = API_URL;
    showTab('routine'); loadRoutine(); loadTasks();
  });
</script>
</head>
<body>
  <div class="hero">
    <div class="hero-inner">
      <div class="brand">
        <div class="logo">S</div>
        <div>
          <div class="title">SmartHelp</div>
          <div class="api-chip">API: <span id="apiurl"></span></div>
        </div>
      </div>
      <button class="cta" onclick="window.scrollTo({top:document.body.scrollHeight,behavior:'smooth'})">Geri Bildirim</button>
    </div>
  </div>

  <div class="tabs">
    <div class="tabs-inner">
      <button id="tab-routine" class="tab active" onclick="showTab('routine');loadRoutine()"><span class="ico">üóìÔ∏è</span>Rutinim</button>
      <button id="tab-food" class="tab" onclick="showTab('food')"><span class="ico">üçΩÔ∏è</span>Yemek</button>
      <button id="tab-movie" class="tab" onclick="showTab('movie')"><span class="ico">üé¨</span>Film</button>
      <button id="tab-tasks" class="tab" onclick="showTab('tasks');loadTasks()"><span class="ico">üè†</span>Ev i≈üleri</button>
      <button id="tab-style" class="tab" onclick="showTab('style')"><span class="ico">üëî</span>Stil</button>
    </div>
  </div>

  <main class="container">
    <!-- Rutinim -->
    <section id="sec-routine" style="display:block">
      <div class="card" style="display:flex;justify-content:space-between;align-items:center">
        <h3>G√ºnl√ºk √ñzet</h3>
        <div class="row">
          <button class="secondary" onclick="loadRoutine()">Yenile</button>
        </div>
      </div>
      <div id="routine-out"></div>
    </section>

    <!-- Yemek -->
    <section id="sec-food">
      <div class="card">
        <h3>Yemek Asistanƒ±</h3>
        <div class="row" style="margin-top:8px">
          <input id="food-q" placeholder="Ne ararsƒ±n? (√∂rn: omlet, √ßorba)" style="flex:1">
          <select id="food-diet"><option value="">Diyet yok</option><option value="vejetaryen">Vejetaryen</option><option value="keto">Keto</option><option value="vegan">Vegan</option></select>
          <button onclick="searchRecipes()">Ara</button>
        </div>
        <div class="row" style="margin-top:8px">
          <input id="food-ings" placeholder="Malzemeleri virg√ºlle yaz (√∂rn: patlƒ±can, kƒ±yma)" style="flex:1">
          <button onclick="byIngredients()">Malzemeden Bul</button>
        </div>
      </div>
      <div id="food-out" class="grid" style="margin-top:10px"></div>
    </section>

    <!-- Film -->
    <section id="sec-movie">
      <div class="card">
        <h3>Film / Dizi</h3>
        <div class="row" style="margin-top:8px">
          <input id="movie-q" placeholder="T√ºr/isim ara (√∂rn: bilimkurgu, inception)" style="flex:1">
          <button onclick="searchMovies()">Ara</button>
        </div>
      </div>
      <div id="movie-out" class="grid" style="margin-top:10px"></div>
    </section>

    <!-- Ev i≈üleri -->
    <section id="sec-tasks">
      <div class="card">
        <h3>Ev i≈üleri</h3>
        <div class="row" style="margin-top:8px">
          <input id="task-title" placeholder="Yeni g√∂rev ekle‚Ä¶" style="flex:1">
          <button onclick="addTask()">Ekle</button>
          <button class="secondary" onclick="loadTasks()">Yenile</button>
        </div>
      </div>
      <div id="tasks-out" style="margin-top:10px"></div>
    </section>

    <!-- Stil -->
    <section id="sec-style">
      <div class="card">
        <h3>Stil Danƒ±≈ümanƒ±</h3>
        <div class="row" style="margin-top:8px">
          <select id="st-oc"><option>g√ºnl√ºk</option><option>i≈ü</option><option>spor</option><option>davet</option></select>
          <select id="st-we"><option>serin</option><option>ƒ±lƒ±k</option><option>sƒ±cak</option><option>soƒüuk</option></select>
          <select id="st-ge"><option>n√∂tr</option><option>erkek</option><option>kadƒ±n</option></select>
          <button onclick="styleSuggest()">√ñner</button>
        </div>
      </div>
      <div id="style-out" style="margin-top:10px"></div>
    </section>
  </main>

  <footer>¬© 2025 SmartHelp ‚Ä¢ Modern Web v2</footer>
</body>
</html>
